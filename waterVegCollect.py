#提取
import pandas as pd
#python D:\Github\xfd_vegetable_price\waterVegCollect.py
waterVegList = ['新发地水菜价格表-20160803.xls',
'新发地水菜价格表-20160804.xls',
'新发地水菜价格表-20160808.xls',
'新发地水菜价格表-20160809.xls',
'新发地水菜价格表-20160810.xls',
'新发地水菜价格表-20160811.xls',
'新发地水菜价格表-20160812.xls',
'新发地水菜价格表-20160815.xls',
'新发地水菜价格表-20160816.xls',
'新发地水菜价格表-20160818.xls',
'新发地水菜价格表-20160819.xls',
'新发地水菜价格表-20160822.xls',
'新发地水菜价格表-20160823.xls',
'新发地水菜价格表-20160824.xls',
'新发地水菜价格表-20160825.xls',
'新发地水菜价格表-20160826.xls',
'新发地水菜价格表-20160829.xls',
'新发地水菜价格表-20160830.xls',
'新发地水菜价格表-20160831.xls',
'新发地水菜价格表-20160901.xls',
'新发地水菜价格表-20160902.xls',
'新发地水菜价格表-20160905.xls',
'新发地水菜价格表-20160906.xls',
'新发地水菜价格表-20160907.xls',
'新发地水菜价格表-20160908.xls',
'新发地水菜价格表-20160909.xls',
'新发地水菜价格表-20160913.xls',
'新发地水菜价格表-20160914.xls',
'新发地水菜价格表-20160915.xls',
'新发地水菜价格表-20160916.xls',
'新发地水菜价格表-20160919.xls',
'新发地水菜价格表-20160920.xls',
'新发地水菜价格表-20160921.xls',
'新发地水菜价格表-20160922.xls',
'新发地水菜价格表-20160923.xls',
'新发地水菜价格表-20160926.xls',
'新发地水菜价格表-20160927.xls',
'新发地水菜价格表-20160928.xls',
'新发地水菜价格表-20160929.xls',
'新发地水菜价格表-20160930.xls',
'新发地水菜价格表-20161003.xls',
'新发地水菜价格表-20161004.xls',
'新发地水菜价格表-20161007.xls',
'新发地水菜价格表-20161010.xls',
'新发地水菜价格表-20161011.xls',
'新发地水菜价格表-20161012.xls',
'新发地水菜价格表-20161013.xls',
'新发地水菜价格表-20161014.xls',
'新发地水菜价格表-20161019.xls',
'新发地水菜价格表-20161020.xls',
'新发地水菜价格表-20161021.xls',
'新发地水菜价格表-20161024.xls',
'新发地水菜价格表-20161025.xls',
'新发地水菜价格表-20161027.xls',
'新发地水菜价格表-20161028.xls',
'新发地水菜价格表-20161031.xls',
'新发地水菜价格表-20161101.xls',
'新发地水菜价格表-20161103.xls',
'新发地水菜价格表-20161110.xls',
'新发地水菜价格表-20161111.xls',
'新发地水菜价格表-20161118.xls',
'新发地水菜价格表-20161121.xls',
'新发地水菜价格表-20161123.xls',
'新发地水菜价格表-20161124.xls',
'新发地水菜价格表-20161125.xls',
'新发地水菜价格表-20161129.xls',
'新发地水菜价格表-20161130.xls',
'新发地水菜价格表-20161201.xls',
'新发地水菜价格表-20161205.xls',
'新发地水菜价格表-20161206.xls',
'新发地水菜价格表-20161209.xls',
'新发地水菜价格表-20161212.xls',
'新发地水菜价格表-20161216.xls',
'新发地水菜价格表-20161220.xls',
'新发地水菜价格表-20161221.xls',
'新发地水菜价格表-20161226.xls',
'新发地水菜价格表-20161227.xls',
'新发地水菜价格表-20161228.xls',
'新发地水菜价格表-20161229.xls',
'新发地水菜价格表-20170103.xls',
'新发地水菜价格表-20170110.xls',
'新发地水菜价格表-20170111.xls',
'新发地水菜价格表-20170113.xls',
'新发地水菜价格表-20170116.xls',
'新发地水菜价格表-20170117.xls',
'新发地水菜价格表-20170120.xls',
'新发地水菜价格表-20170125.xls',
'新发地水菜价格表-20170202.xls',
'新发地水菜价格表-20170203.xls',
'新发地水菜价格表-20170207.xls',
'新发地水菜价格表-20170208.xls',
'新发地水菜价格表-20170209.xls',
'新发地水菜价格表-20170215.xls',
'新发地水菜价格表-20170216.xls',
'新发地水菜价格表-20170217.xls',
'新发地水菜价格表-20170220.xls',
'新发地水菜价格表-20170221.xls',
'新发地水菜价格表-20170223.xls',
'新发地水菜价格表-20170228.xls',
'新发地水菜价格表-20170301.xls',
'新发地水菜价格表-20170302.xls',
'新发地水菜价格表-20170303.xls',
'新发地水菜价格表-20170306.xls',
'新发地水菜价格表-20170307.xls',
'新发地水菜价格表-20170314.xls',
'新发地水菜价格表-20170315.xls',
'新发地水菜价格表-20170316.xls',
'新发地水菜价格表-20170317.xls',
'新发地水菜价格表-20170320.xls',
'新发地水菜价格表-20170329.xls',
'新发地水菜价格表-20170330.xls',
'新发地水菜价格表-20170331.xls',
'新发地水菜价格表-20170403.xls',
'新发地水菜价格表-20170404.xls',
'新发地水菜价格表-20170411.xls',
'新发地水菜价格表-20170414.xls',
'新发地水菜价格表-20170417.xls',
'新发地水菜价格表-20170426.xls',
'新发地水菜价格表-20170427.xls',
'新发地水菜价格表-20170501.xls',
'新发地水菜价格表-20170502.xls',
'新发地水菜价格表-20170503.xls',
'新发地水菜价格表-20170504.xls',
'新发地水菜价格表-20170505.xls',
'新发地水菜价格表-20170508.xls',
'新发地水菜价格表-20170509.xls',
'新发地水菜价格表-20170511.xls',
'新发地水菜价格表-20170522.xls',
'新发地水菜价格表-20170602.xls',
'新发地水菜价格表-20170605.xls',
'新发地水菜价格表-20170612.xls',
'新发地水菜价格表-20170626.xls',
'新发地水菜价格表-20170627.xls',
'新发地水菜价格表-20170628.xls',
'新发地水菜价格表-20170629.xls',
'新发地水菜价格表-20170630.xls',
'新发地水菜价格表-20170703.xls',
'新发地水菜价格表-20170704.xls',
'新发地水菜价格表-20170705.xls',
'新发地水菜价格表-20170706.xls',
'新发地水菜价格表-20170707.xls',
'新发地水菜价格表-20170710.xls',
'新发地水菜价格表-20170711.xls',
'新发地水菜价格表-20170712.xls',
'新发地水菜价格表-20170713.xls',
'新发地水菜价格表-20170714.xls',
'新发地水菜价格表-20170717.xls',
'新发地水菜价格表-20170718.xls',
'新发地水菜价格表-20170719.xls',
'新发地水菜价格表-20170720.xls',
'新发地水菜价格表-20170724.xls',
'新发地水菜价格表-20170725.xls',
'新发地水菜价格表-20170726.xls',
'新发地水菜价格表-20170727.xls',
'新发地水菜价格表-20170728.xls',
'新发地水菜价格表-20170731.xls',
'新发地水菜价格表-20170801.xls',
'新发地水菜价格表-20170802.xls',
'新发地水菜价格表-20170803.xls',
'新发地水菜价格表-20170804.xls',
'新发地水菜价格表-20170807.xls',
'新发地水菜价格表-20170808.xls',
'新发地水菜价格表-20170809.xls',
'新发地水菜价格表-20170810.xls',
'新发地水菜价格表-20170814.xls',
'新发地水菜价格表-20170815.xls',
'新发地水菜价格表-20170816.xls',
'新发地水菜价格表-20170817.xls',
'新发地水菜价格表-20170818.xls',
'新发地水菜价格表-20170821.xls',
'新发地水菜价格表-20170822.xls',
'新发地水菜价格表-20170823.xls',
'新发地水菜价格表-20170824.xls',
'新发地水菜价格表-20170825.xls',
'新发地水菜价格表-20170828.xls',
'新发地水菜价格表-20170829.xls',
'新发地水菜价格表-20170830.xls',
'新发地水菜价格表-20170831.xls',
'新发地水菜价格表-20170901.xls',
'新发地水菜价格表-20170904.xls',
'新发地水菜价格表-20170905.xls',
'新发地水菜价格表-20170906.xls',
'新发地水菜价格表-20170907.xls',
'新发地水菜价格表-20170908.xls',
'新发地水菜价格表-20170911.xls',
'新发地水菜价格表-20170912.xls',
'新发地水菜价格表-20170913.xls',
'新发地水菜价格表-20170914.xls',
'新发地水菜价格表-20170918.xls',
'新发地水菜价格表-20170919.xls',
'新发地水菜价格表-20170920.xls',
'新发地水菜价格表-20170921.xls',
'新发地水菜价格表-20170922.xls',
'新发地水菜价格表-20170925.xls',
'新发地水菜价格表-20170927.xls',
'新发地水菜价格表-20170928.xls',
'新发地水菜价格表-20170929.xls',
'新发地水菜价格表-20171002.xls',
'新发地水菜价格表-20171003.xls',
'新发地水菜价格表-20171004.xls',
'新发地水菜价格表-20171005.xls',
'新发地水菜价格表-20171006.xls',
'新发地水菜价格表-20171009.xls',
'新发地水菜价格表-20171010.xls',
'新发地水菜价格表-20171011.xls',
'新发地水菜价格表-20171012.xls',
'新发地水菜价格表-20171013.xls',
'新发地水菜价格表-20171016.xls',
'新发地水菜价格表-20171017.xls',
'新发地水菜价格表-20171018.xls',
'新发地水菜价格表-20171019.xls',
'新发地水菜价格表-20171020.xls',
'新发地水菜价格表-20171023.xls',
'新发地水菜价格表-20171024.xls',
'新发地水菜价格表-20171026.xls',
'新发地水菜价格表-20171027.xls',
'新发地水菜价格表-20171030.xls',
'新发地水菜价格表-20171031.xls',
'新发地水菜价格表-20171101.xls',
'新发地水菜价格表-20171102.xls',
'新发地水菜价格表-20171106.xls',
'新发地水菜价格表-20171107.xls',
'新发地水菜价格表-20171108.xls',
'新发地水菜价格表-20171109.xls',
'新发地水菜价格表-20171110.xls',
'新发地水菜价格表-20171113.xls',
'新发地水菜价格表-20171114.xls',
'新发地水菜价格表-20171115.xls',
'新发地水菜价格表-20171116.xls',
'新发地水菜价格表-20171117.xls',
'新发地水菜价格表-20171120.xls',
'新发地水菜价格表-20171121.xls',
'新发地水菜价格表-20171122.xls',
'新发地水菜价格表-20171123.xls',
'新发地水菜价格表-20171124.xls',
'新发地水菜价格表-20171127.xls',
'新发地水菜价格表-20171128.xls',
'新发地水菜价格表-20171129.xls',
'新发地水菜价格表-20171130.xls',
'新发地水菜价格表-20171201.xls',
'新发地水菜价格表-20171204.xls',
'新发地水菜价格表-20171206.xls',
'新发地水菜价格表-20171207.xls',
'新发地水菜价格表-20171208.xls',
'新发地水菜价格表-20171211.xls',
'新发地水菜价格表-20171212.xls',
'新发地水菜价格表-20171213.xls',
'新发地水菜价格表-20171214.xls',
'新发地水菜价格表-20171215.xls',
'新发地水菜价格表-20171218.xls',
'新发地水菜价格表-20171219.xls',
'新发地水菜价格表-20171220.xls',
'新发地水菜价格表-20171221.xls',
'新发地水菜价格表-20171222.xls',
'新发地水菜价格表-20171225.xls',
'新发地水菜价格表-20171226.xls',
'新发地水菜价格表-20171227.xls',
'新发地水菜价格表-20171228.xls',
'新发地水菜价格表-20171229.xls',
'新发地水菜价格表-20180101.xls',
'新发地水菜价格表-20180102.xls',
'新发地水菜价格表-20180108.xls',
'新发地水菜价格表-20180109.xls',
'新发地水菜价格表-20180110.xls',
'新发地水菜价格表-20180111.xls',
'新发地水菜价格表-20180112.xls',
'新发地水菜价格表-20180115.xls',
'新发地水菜价格表-20180116.xls',
'新发地水菜价格表-20180117.xls',
'新发地水菜价格表-20180118.xls',
'新发地水菜价格表-20180119.xls',
'新发地水菜价格表-20180122.xls',
'新发地水菜价格表-20180123.xls',
'新发地水菜价格表-20180124.xls',
'新发地水菜价格表-20180125.xls',
'新发地水菜价格表-20180126.xls',
'新发地水菜价格表-20180129.xls',
'新发地水菜价格表-20180130.xls',
'新发地水菜价格表-20180131.xls',
'新发地水菜价格表-20180201.xls',
'新发地水菜价格表-20180202.xls',
'新发地水菜价格表-20180205.xls',
'新发地水菜价格表-20180206.xls',
'新发地水菜价格表-20180207.xls',
'新发地水菜价格表-20180208.xls',
'新发地水菜价格表-20180209.xls',
'新发地水菜价格表-20180212.xls',
'新发地水菜价格表-20180213.xls',
'新发地水菜价格表-20180214.xls',
'新发地水菜价格表-20180221.xls',
'新发地水菜价格表-20180222.xls',
'新发地水菜价格表-20180223.xls',
'新发地水菜价格表-20180226.xls',
'新发地水菜价格表-20180227.xls',
'新发地水菜价格表-20180228.xls',
'新发地水菜价格表-20180301.xls',
'新发地水菜价格表-20180302.xls',
'新发地水菜价格表-20180305.xls',
'新发地水菜价格表-20180306.xls',
'新发地水菜价格表-20180307.xls',
'新发地水菜价格表-20180308.xls',
'新发地水菜价格表-20180309.xls',
'新发地水菜价格表-20180312.xls',
'新发地水菜价格表-20180313.xls',
'新发地水菜价格表-20180314.xls',
'新发地水菜价格表-20180315.xls',
'新发地水菜价格表-20180316.xls',
'新发地水菜价格表-20180319.xls',
'新发地水菜价格表-20180320.xls',
'新发地水菜价格表-20180321.xls',
'新发地水菜价格表-20180322.xls',
'新发地水菜价格表-20180323.xls',
'新发地水菜价格表-20180326.xls',
'新发地水菜价格表-20180327.xls',
'新发地水菜价格表-20180328.xls',
'新发地水菜价格表-20180329.xls',
'新发地水菜价格表-20180330.xls',
'新发地水菜价格表-20180402.xls',
'新发地水菜价格表-20180403.xls',
'新发地水菜价格表-20180404.xls',
'新发地水菜价格表-20180405.xls',
'新发地水菜价格表-20180406.xls',
'新发地水菜价格表-20180409.xls',
'新发地水菜价格表-20180410.xls',
'新发地水菜价格表-20180411.xls',
'新发地水菜价格表-20180412.xls',
'新发地水菜价格表-20180413.xls',
'新发地水菜价格表-20180416.xls',
'新发地水菜价格表-20180417.xls',
'新发地水菜价格表-20180418.xls',
'新发地水菜价格表-20180419.xls',
'新发地水菜价格表-20180420.xls',
'新发地水菜价格表-20180423.xls',
'新发地水菜价格表-20180424.xls',
'新发地水菜价格表-20180425.xls',
'新发地水菜价格表-20180426.xls',
'新发地水菜价格表-20180430.xls',
'新发地水菜价格表-20180501.xls',
'新发地水菜价格表-20180502.xls',
'新发地水菜价格表-20180503.xls',
'新发地水菜价格表-20180504.xls',
'新发地水菜价格表-20180507.xls',
'新发地水菜价格表-20180508.xls',
'新发地水菜价格表-20180510.xls',
'新发地水菜价格表-20180511.xls',
'新发地水菜价格表-20180514.xls',
'新发地水菜价格表-20180515.xls',
'新发地水菜价格表-20180516.xls',
'新发地水菜价格表-20180517.xls',
'新发地水菜价格表-20180518.xls',
'新发地水菜价格表-20180521.xls',
'新发地水菜价格表-20180522.xls',
'新发地水菜价格表-20180523.xls',
'新发地水菜价格表-20180524.xls',
'新发地水菜价格表-20180525.xls',
'新发地水菜价格表-20180528.xls',
'新发地水菜价格表-20180529.xls',
'新发地水菜价格表-20180530.xls',
'新发地水菜价格表-20180531.xls',
'新发地水菜价格表-20180601.xls',
'新发地水菜价格表-20180604.xls',
'新发地水菜价格表-20180605.xls',
'新发地水菜价格表-20180606.xls',
'新发地水菜价格表-20180607.xls',
'新发地水菜价格表-20180608.xls',
'新发地水菜价格表-20180611.xls',
'新发地水菜价格表-20180612.xls',
'新发地水菜价格表-20180613.xls',
'新发地水菜价格表-20180614.xls',
'新发地水菜价格表-20180615.xls',
'新发地水菜价格表-20180618.xls',
'新发地水菜价格表-20180619.xls',
'新发地水菜价格表-20180620.xls',
'新发地水菜价格表-20180621.xls',
'新发地水菜价格表-20180622.xls',
'新发地水菜价格表-20180625.xls',
'新发地水菜价格表-20180626.xls',
'新发地水菜价格表-20180627.xls',
'新发地水菜价格表-20180628.xls',
'新发地水菜价格表-20180629.xls',
'新发地水菜价格表-20180702.xls',
'新发地水菜价格表-20180703.xls',
'新发地水菜价格表-20180704.xls',
'新发地水菜价格表-20180705.xls',
'新发地水菜价格表-20180706.xls',
'新发地水菜价格表-20180709.xls',
'新发地水菜价格表-20180710.xls',
'新发地水菜价格表-20180711.xls',
'新发地水菜价格表-20180712.xls',
'新发地水菜价格表-20180713.xls',
'新发地水菜价格表-20180716.xls',
'新发地水菜价格表-20180717.xls',
'新发地水菜价格表-20180718.xls',
'新发地水菜价格表-20180719.xls',
'新发地水菜价格表-20180720.xls'
]

#提取第一个文件
df = pd.read_excel('D:\Data\新发地菜价\水菜\新发地水菜价格表-20160803.xls', sheet_name='Sheet1', header = 2, skipfooter=3)
#print(df.describe())
df['日期'] = '2016-08-03'
print(df.head())

#提取其他文件
for i in range(1, len(waterVegList)):
    docName = waterVegList[i]
    doc_address = r'D:\Data\新发地菜价\水菜'
    doc_address += '\\' + docName
    #print("本次打开的文件名为：", docName)
    df_temp = pd.read_excel(doc_address, sheet_name='Sheet1', header = 2, skipfooter=3)
    #print(df_temp.head())
    colDate = str(docName[9:13]) + '-' + str(docName[13:15]) + '-' + str(docName[15:17])
    #print('本次添加的colDate为：', colDate)
    #print(type(colDate))
    df_temp['日期'] = colDate
    df = df.append(df_temp)
    i += 1

print(df.tail())
writer = r'D:\Data\新发地菜价\水菜\水菜价格汇总.xls'
df.to_excel(writer, sheet_name='水菜价格汇总')

#python D:\Github\xfd_vegetable_price\waterVegCollect.py
